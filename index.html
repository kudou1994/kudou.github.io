<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ é©¬å¹´ç¥ç¦ - AI åŠ æŒ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #1a0a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: #fff;
        }

        /* èƒŒæ™¯åŠ¨ç”» */
        .bg-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .bg-animation span {
            position: absolute;
            display: block;
            width: 20px;
            height: 20px;
            background: rgba(255, 215, 0, 0.3);
            animation: move 25s infinite linear;
            bottom: -150px;
            border-radius: 50%;
        }

        .bg-animation span:nth-child(1) { left: 5%; width: 80px; height: 80px; animation-delay: 0s; }
        .bg-animation span:nth-child(2) { left: 15%; width: 40px; height: 40px; animation-delay: 2s; animation-duration: 12s; }
        .bg-animation span:nth-child(3) { left: 25%; width: 60px; height: 60px; animation-delay: 4s; }
        .bg-animation span:nth-child(4) { left: 35%; width: 90px; height: 90px; animation-delay: 0s; animation-duration: 18s; }
        .bg-animation span:nth-child(5) { left: 45%; width: 50px; height: 50px; animation-delay: 6s; }
        .bg-animation span:nth-child(6) { left: 55%; width: 70px; height: 70px; animation-delay: 3s; }
        .bg-animation span:nth-child(7) { left: 65%; width: 40px; height: 40px; animation-delay: 7s; }
        .bg-animation span:nth-child(8) { left: 75%; width: 80px; height: 80px; animation-delay: 2s; animation-duration: 20s; }
        .bg-animation span:nth-child(9) { left: 85%; width: 60px; height: 60px; animation-delay: 5s; }
        .bg-animation span:nth-child(10) { left: 95%; width: 90px; height: 90px; animation-delay: 1s; }

        @keyframes move {
            0% {
                transform: translateY(0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(-1000px) rotate(720deg);
                opacity: 0;
            }
        }

        /* ä¸»å®¹å™¨ */
        .container {
            max-width: 500px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        /* å¤´éƒ¨ */
        .header {
            text-align: center;
            padding: 40px 0 20px;
        }

        .horse-icon {
            font-size: 80px;
            animation: bounce 2s infinite;
            display: inline-block;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        .title {
            font-size: 2.5rem;
            margin-top: 20px;
            background: linear-gradient(45deg, #ffd700, #ff6b6b, #ffd700);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shine 3s linear infinite;
            font-weight: bold;
        }

        @keyframes shine {
            to { background-position: 200% center; }
        }

        .subtitle {
            font-size: 1.2rem;
            color: #a0a0a0;
            margin-top: 10px;
        }

        /* ç¥ç¦å¡ç‰‡ */
        .blessing-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px 20px;
            margin: 30px 0;
            border: 1px solid rgba(255, 215, 0, 0.3);
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.2);
            animation: pulse 3s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 8px 32px rgba(255, 215, 0, 0.2); }
            50% { box-shadow: 0 8px 50px rgba(255, 215, 0, 0.4); }
        }

        .blessing-text {
            font-size: 1.3rem;
            line-height: 2.2;
            text-align: center;
        }

        .blessing-text .highlight {
            color: #ffd700;
            font-weight: bold;
        }

        .blessing-text .emoji {
            font-size: 1.5rem;
        }

        /* ç™»å½•åŒºåŸŸ */
        .auth-section {
            text-align: center;
            margin: 30px 0;
        }

        .login-btn {
            background: linear-gradient(45deg, #24292e, #444);
            color: #fff;
            border: none;
            padding: 15px 40px;
            font-size: 1.1rem;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.4);
        }

        .login-btn .github-icon {
            font-size: 1.5rem;
        }

        /* å¼¹å¹•è¾“å…¥åŒºåŸŸ */
        .danmaku-input-section {
            display: none;
            margin: 20px 0;
        }

        .danmaku-input-section.show {
            display: block;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid #ffd700;
        }

        .user-name {
            color: #ffd700;
            font-weight: bold;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .danmaku-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid rgba(255, 215, 0, 0.5);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .danmaku-input:focus {
            border-color: #ffd700;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }

        .danmaku-input::placeholder {
            color: #888;
        }

        .send-btn {
            padding: 12px 25px;
            background: linear-gradient(45deg, #ffd700, #ff6b6b);
            border: none;
            border-radius: 25px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .send-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.5);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* å¼¹å¹•åŒºåŸŸ */
        .danmaku-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 100;
            overflow: hidden;
        }

        .danmaku-item {
            position: absolute;
            white-space: nowrap;
            padding: 8px 20px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 20px;
            color: #fff;
            font-size: 14px;
            border: 1px solid rgba(255, 215, 0, 0.5);
            animation: danmakuMove linear forwards;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .danmaku-item .sender {
            color: #ffd700;
            font-weight: bold;
            margin-right: 5px;
        }

        @keyframes danmakuMove {
            from { transform: translateX(100vw); }
            to { transform: translateX(-100%); }
        }

        /* åŠ è½½çŠ¶æ€ */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* æç¤ºä¿¡æ¯ */
        .toast {
            position: fixed;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 15px 30px;
            border-radius: 10px;
            z-index: 1000;
            transition: all 0.3s ease;
            opacity: 0;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        .toast.success {
            border: 1px solid #4CAF50;
        }

        .toast.error {
            border: 1px solid #f44336;
        }

        /* åº•éƒ¨ */
        .footer {
            text-align: center;
            padding: 30px 0;
            color: #666;
            font-size: 0.9rem;
        }

        /* å“åº”å¼ */
        @media (max-width: 480px) {
            .title {
                font-size: 2rem;
            }
            .blessing-text {
                font-size: 1.1rem;
            }
            .horse-icon {
                font-size: 60px;
            }
        }

        /* çƒŸèŠ±æ•ˆæœ */
        .firework {
            position: fixed;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            pointer-events: none;
            z-index: 50;
        }

        .firework-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: particleExpand 1s ease-out forwards;
        }

        @keyframes particleExpand {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty));
                opacity: 0;
            }
        }

        /* ç™»å½•ä¸­çŠ¶æ€ */
        .login-processing {
            text-align: center;
            padding: 20px;
            color: #ffd700;
        }
    </style>
</head>
<body>
    <!-- èƒŒæ™¯åŠ¨ç”» -->
    <div class="bg-animation">
        <span></span><span></span><span></span><span></span><span></span>
        <span></span><span></span><span></span><span></span><span></span>
    </div>

    <!-- å¼¹å¹•å®¹å™¨ -->
    <div class="danmaku-container" id="danmakuContainer"></div>

    <!-- ä¸»å®¹å™¨ -->
    <div class="container">
        <!-- å¤´éƒ¨ -->
        <div class="header">
            <div class="horse-icon">ğŸ</div>
            <h1 class="title">é©¬å¹´å¤§å‰</h1>
            <p class="subtitle">AI åŠ æŒ Â· æ™ºå¯æ–°ç¨‹</p>
        </div>

        <!-- ç¥ç¦å¡ç‰‡ -->
        <div class="blessing-card">
            <div class="blessing-text">
                <p><span class="emoji">ğŸ</span> é©¬å¹´é©¾åˆ°ï¼Œ<span class="highlight">AI åŠ æŒ</span>ï¼</p>
                <p>èµµå®‡åœ¨è¿™é‡Œç¥æ‚¨ï¼š</p>
                <p><span class="emoji">âœ¨</span> <span class="highlight">AI</span> åˆ†çç¢ï¼Œé—²æ—¶ä¼´å®¶äººã€‚</p>
                <p><span class="emoji">âœ¨</span> æ™ºèƒ½å¯æ¢¦æƒ³ï¼Œåˆ›æ„ä»»é©°é£ã€‚</p>
                <p><span class="emoji">âœ¨</span> äººæœºå…±åä½œï¼Œæ™ºå¼•å‘ä¹¾å¤ï¼</p>
            </div>
        </div>

        <!-- ç™»å½•ä¸­æç¤º -->
        <div class="login-processing" id="loginProcessing" style="display: none;">
            <span class="loading"></span>
            <p style="margin-top: 10px;">æ­£åœ¨ç™»å½•...</p>
        </div>

        <!-- ç™»å½•/å¼¹å¹•åŒºåŸŸ -->
        <div class="auth-section" id="authSection">
            <button class="login-btn" id="loginBtn" onclick="handleLogin()">
                <span class="github-icon">ğŸ™</span>
                <span id="loginBtnText">GitHub ç™»å½•å‘é€å¼¹å¹•</span>
            </button>
        </div>

        <!-- å¼¹å¹•è¾“å…¥åŒºåŸŸ -->
        <div class="danmaku-input-section" id="danmakuInputSection">
            <div class="user-info">
                <img class="user-avatar" id="userAvatar" src="" alt="avatar">
                <span class="user-name" id="userName"></span>
                <button onclick="handleLogout()" style="background:none;border:none;color:#888;cursor:pointer;margin-left:10px;">é€€å‡º</button>
            </div>
            <div class="input-group">
                <input type="text" class="danmaku-input" id="danmakuInput" placeholder="å‘é€ä½ çš„ç¥ç¦å¼¹å¹•..." maxlength="50">
                <button class="send-btn" id="sendBtn" onclick="sendDanmaku()">å‘é€</button>
            </div>
        </div>

        <!-- åº•éƒ¨ -->
        <div class="footer">
            <p>ğŸŠ 2026 é©¬å¹´ç¥ç¦ ğŸŠ</p>
            <p>å¼¹å¹•æ•°æ®å­˜å‚¨åœ¨ GitHub Issues</p>
        </div>
    </div>

    <!-- æç¤ºæ¡† -->
    <div class="toast" id="toast"></div>

    <script>
        // GitHub é…ç½®
        const GITHUB_CONFIG = {
            clientId: 'Ov23liuXYxHOmaUSKNUx',
            owner: 'kudou1994',
            repo: 'kudou.github.io'
        };

        // çŠ¶æ€ç®¡ç†
        let accessToken = null;
        let userInfo = null;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', () => {
            console.log('[DEBUG] é¡µé¢åŠ è½½å®Œæˆ');
            checkAuth();
            loadDanmaku();
            createFireworks();
            
            // å®šæœŸåŠ è½½å¼¹å¹•
            setInterval(loadDanmaku, 5000);
        });

        // æ£€æŸ¥ç™»å½•çŠ¶æ€ - ä¿®å¤ç‰ˆ
        function checkAuth() {
            console.log('[DEBUG] å¼€å§‹æ£€æŸ¥è®¤è¯çŠ¶æ€');
            
            // 1. å…ˆä» URL hash ä¸­è·å– tokenï¼ˆOAuth å›è°ƒï¼‰
            const hash = window.location.hash;
            console.log('[DEBUG] URL hash:', hash);
            
            if (hash && hash.includes('access_token=')) {
                console.log('[DEBUG] å‘ç° access_token åœ¨ hash ä¸­');
                try {
                    // æ›´å¥å£®çš„è§£ææ–¹å¼
                    const hashParams = new URLSearchParams(hash.substring(1));
                    const tokenFromHash = hashParams.get('access_token');
                    
                    if (tokenFromHash) {
                        accessToken = tokenFromHash;
                        localStorage.setItem('github_token', accessToken);
                        console.log('[DEBUG] Token å·²ä¿å­˜åˆ° localStorage');
                        
                        // æ¸…é™¤ hashï¼ˆä¸åˆ·æ–°é¡µé¢ï¼‰
                        window.history.replaceState({}, document.title, window.location.pathname + window.location.search);
                        
                        // æ˜¾ç¤ºç™»å½•ä¸­çŠ¶æ€
                        showLoginProcessing();
                        
                        // è·å–ç”¨æˆ·ä¿¡æ¯
                        fetchUserInfo();
                        return;
                    }
                } catch (e) {
                    console.error('[DEBUG] è§£æ hash å¤±è´¥:', e);
                }
            }
            
            // 2. ä» localStorage è·å–å·²ä¿å­˜çš„ token
            const storedToken = localStorage.getItem('github_token');
            console.log('[DEBUG] localStorage ä¸­çš„ token:', storedToken ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨');
            
            if (storedToken) {
                accessToken = storedToken;
                showLoginProcessing();
                fetchUserInfo();
            } else {
                console.log('[DEBUG] æœªæ‰¾åˆ° tokenï¼Œæ˜¾ç¤ºç™»å½•æŒ‰é’®');
                showLoginButton();
            }
        }

        // æ˜¾ç¤ºç™»å½•ä¸­çŠ¶æ€
        function showLoginProcessing() {
            document.getElementById('loginProcessing').style.display = 'block';
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('danmakuInputSection').classList.remove('show');
        }

        // æ˜¾ç¤ºç™»å½•æŒ‰é’®
        function showLoginButton() {
            document.getElementById('loginProcessing').style.display = 'none';
            document.getElementById('authSection').style.display = 'block';
            document.getElementById('danmakuInputSection').classList.remove('show');
        }

        // å¤„ç†ç™»å½•
        function handleLogin() {
            console.log('[DEBUG] ç”¨æˆ·ç‚¹å‡»ç™»å½•æŒ‰é’®');
            
            // è·å–å½“å‰å®Œæ•´ URL ä½œä¸ºå›è°ƒåœ°å€ï¼ˆç¡®ä¿ä¸ GitHub OAuth App é…ç½®ä¸€è‡´ï¼‰
            const currentUrl = 'https://kudou1994.github.io/kudou.github.io/';
            console.log('[DEBUG] å›è°ƒ URL:', currentUrl);
            
            const redirectUri = currentUrl;
            const authUrl = `https://github.com/login/oauth/authorize?client_id=${GITHUB_CONFIG.clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&scope=public_repo`;
            
            console.log('[DEBUG] è·³è½¬æˆæƒ URL:', authUrl);
            window.location.href = authUrl;
        }

        // è·å–ç”¨æˆ·ä¿¡æ¯ - ä¿®å¤ç‰ˆ
        async function fetchUserInfo() {
            console.log('[DEBUG] å¼€å§‹è·å–ç”¨æˆ·ä¿¡æ¯');
            
            if (!accessToken) {
                console.error('[DEBUG] æ²¡æœ‰ access token');
                showLoginButton();
                return;
            }

            try {
                const response = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${accessToken}`,
                        'Accept': 'application/vnd.github.v3+json'
                    }
                });

                console.log('[DEBUG] GitHub API å“åº”çŠ¶æ€:', response.status);

                if (response.ok) {
                    userInfo = await response.json();
                    console.log('[DEBUG] è·å–ç”¨æˆ·ä¿¡æ¯æˆåŠŸ:', userInfo.login);
                    showLoggedInState();
                } else if (response.status === 401) {
                    console.error('[DEBUG] Token æ— æ•ˆï¼Œæ¸…é™¤å¹¶æ˜¾ç¤ºç™»å½•æŒ‰é’®');
                    handleLogout();
                    showToast('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•', 'error');
                } else {
                    const errorText = await response.text();
                    console.error('[DEBUG] è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', response.status, errorText);
                    showLoginButton();
                    showToast('è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥', 'error');
                }
            } catch (error) {
                console.error('[DEBUG] è·å–ç”¨æˆ·ä¿¡æ¯å¼‚å¸¸:', error);
                showLoginButton();
                showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•', 'error');
            }
        }

        // æ˜¾ç¤ºç™»å½•çŠ¶æ€ - ä¿®å¤ç‰ˆ
        function showLoggedInState() {
            console.log('[DEBUG] æ˜¾ç¤ºå·²ç™»å½•çŠ¶æ€');
            
            document.getElementById('loginProcessing').style.display = 'none';
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('danmakuInputSection').classList.add('show');
            
            document.getElementById('userAvatar').src = userInfo.avatar_url;
            document.getElementById('userName').textContent = userInfo.login;
            
            console.log('[DEBUG] å¼¹å¹•è¾“å…¥æ¡†åº”è¯¥å·²æ˜¾ç¤º');
            
            // éªŒè¯æ˜¯å¦çœŸçš„æ˜¾ç¤ºäº†
            setTimeout(() => {
                const section = document.getElementById('danmakuInputSection');
                const isShown = section.classList.contains('show');
                const displayStyle = window.getComputedStyle(section).display;
                console.log('[DEBUG] å¼¹å¹•åŒºåŸŸçŠ¶æ€ - class show:', isShown, 'display:', displayStyle);
                
                if (!isShown) {
                    console.error('[DEBUG] å¼¹å¹•åŒºåŸŸæœªæ­£ç¡®æ˜¾ç¤ºï¼Œå°è¯•å¼ºåˆ¶æ˜¾ç¤º');
                    section.style.display = 'block';
                }
            }, 100);
            
            showToast('ç™»å½•æˆåŠŸï¼', 'success');
        }

        // é€€å‡ºç™»å½•
        function handleLogout() {
            console.log('[DEBUG] ç”¨æˆ·é€€å‡ºç™»å½•');
            accessToken = null;
            userInfo = null;
            localStorage.removeItem('github_token');
            showLoginButton();
            document.getElementById('danmakuInput').value = '';
            showToast('å·²é€€å‡ºç™»å½•', 'success');
        }

        // å‘é€å¼¹å¹•
        async function sendDanmaku() {
            const input = document.getElementById('danmakuInput');
            const sendBtn = document.getElementById('sendBtn');
            const message = input.value.trim();

            if (!message) {
                showToast('è¯·è¾“å…¥å¼¹å¹•å†…å®¹', 'error');
                return;
            }

            sendBtn.disabled = true;
            sendBtn.innerHTML = '<span class="loading"></span>';

            try {
                const response = await fetch(`https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/issues`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `token ${accessToken}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        title: `ğŸŠ å¼¹å¹• - ${userInfo.login} - ${Date.now()}`,
                        body: message,
                        labels: ['danmaku', 'blessing']
                    })
                });

                if (response.ok) {
                    showToast('å¼¹å¹•å‘é€æˆåŠŸï¼', 'success');
                    input.value = '';
                    loadDanmaku();
                    createFirework();
                } else {
                    const error = await response.json();
                    showToast(`å‘é€å¤±è´¥ï¼š${error.message}`, 'error');
                }
            } catch (error) {
                console.error('å‘é€å¼¹å¹•å¤±è´¥:', error);
                showToast('å‘é€å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
            } finally {
                sendBtn.disabled = false;
                sendBtn.innerHTML = 'å‘é€';
            }
        }

        // åŠ è½½å¼¹å¹•
        async function loadDanmaku() {
            try {
                const response = await fetch(
                    `https://api.github.com/repos/${GITHUB_CONFIG.owner}/${GITHUB_CONFIG.repo}/issues?labels=danmaku&state=all&per_page=50`,
                    {
                        headers: {
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );

                if (response.ok) {
                    const issues = await response.json();
                    const danmakuList = issues
                        .filter(issue => issue.body && issue.title.includes('å¼¹å¹•'))
                        .slice(0, 20);
                    
                    const existingDanmaku = document.querySelectorAll('.danmaku-item');
                    const existingTitles = Array.from(existingDanmaku).map(d => d.dataset.title);
                    
                    danmakuList.forEach((issue, index) => {
                        if (!existingTitles.includes(issue.title)) {
                            setTimeout(() => {
                                createDanmaku(issue);
                            }, index * 500);
                        }
                    });
                }
            } catch (error) {
                console.error('åŠ è½½å¼¹å¹•å¤±è´¥:', error);
            }
        }

        // åˆ›å»ºå¼¹å¹•
        function createDanmaku(issue) {
            const container = document.getElementById('danmakuContainer');
            const danmaku = document.createElement('div');
            danmaku.className = 'danmaku-item';
            danmaku.dataset.title = issue.title;
            
            const titleMatch = issue.title.match(/å¼¹å¹• - (.+) - /);
            const sender = titleMatch ? titleMatch[1] : 'åŒ¿åç”¨æˆ·';
            
            danmaku.innerHTML = `<span class="sender">${sender}:</span>${issue.body}`;
            
            const top = Math.random() * 80 + 10;
            danmaku.style.top = top + '%';
            
            const duration = Math.random() * 10 + 10;
            danmaku.style.animationDuration = duration + 's';
            
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#95e1d3', '#f38181'];
            danmaku.style.borderColor = colors[Math.floor(Math.random() * colors.length)];
            
            container.appendChild(danmaku);
            
            setTimeout(() => {
                if (danmaku.parentNode) {
                    danmaku.remove();
                }
            }, duration * 1000);
        }

        // æ˜¾ç¤ºæç¤º
        function showToast(message, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type} show`;
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // åˆ›å»ºçƒŸèŠ±
        function createFireworks() {
            setInterval(() => {
                if (Math.random() > 0.7) {
                    createFirework();
                }
            }, 2000);
        }

        function createFirework() {
            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight * 0.5;
            
            const firework = document.createElement('div');
            firework.className = 'firework';
            firework.style.left = x + 'px';
            firework.style.top = y + 'px';
            document.body.appendChild(firework);
            
            const colors = ['#ffd700', '#ff6b6b', '#4ecdc4', '#95e1d3', '#f38181', '#fff'];
            
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'firework-particle';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                
                const angle = (i / 20) * Math.PI * 2;
                const distance = Math.random() * 80 + 40;
                const tx = Math.cos(angle) * distance;
                const ty = Math.sin(angle) * distance;
                
                particle.style.setProperty('--tx', tx + 'px');
                particle.style.setProperty('--ty', ty + 'px');
                particle.style.left = '50%';
                particle.style.top = '50%';
                
                firework.appendChild(particle);
            }
            
            setTimeout(() => {
                firework.remove();
            }, 1500);
        }

        // å›è½¦å‘é€
        document.getElementById('danmakuInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                sendDanmaku();
            }
        });
    </script>
</body>
</html>
